<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>epstool</title>
<link rel="stylesheet" type="text/css" href="gsview.css" title="GSview Style">
</head>
<body>
<h1>
epstool
</h1>
<p>
EPSTOOL - Create or extract preview bitmaps in EPS files.
<br>
Release date: 2000-12-27
</p>
<h2>
Table of contents
</h2>
<ul>
<li><a href="#Overview">Overview</a>
<li><a href="#Examples">Examples</a>
<li><a href="#Notes">Notes</a>
<li><a href="#Copyright">Copyright</a>
<li><a href="#Other">Other tools</a>
<li><a href="#Revision">Revision History</a>
</ul>

<h2>
<a name="Overview"></a>
Overview
</h2>

<p>
Epstool is a utility to create or extract preview images in
EPS files.
</p>

<p>
If you have precompiled executables, epstool.exe is a Win32 console EXE,
epstool2.exe is an OS/2 console EXE.
</p>

<p>
<b>
Features:
</b>
</p>
<ul>
 <li> Add EPSI or DOS EPS previews.
 <li> Extract PostScript from DOS EPS files.
 <li> Uses Ghostscript to create preview bitmaps.
 <li> Scan a bitmap created by Ghostscript to find bounding box.
 <li> Create a TIFF, WMF or Interchange preview from part of a 
  bitmap created by Ghostscript.
 <li> output to stdout or file.
 <li> input must be from a file.
 <li> works under Win32, MS-DOS, OS/2 and Unix.
 <li> works on little-endian machines (Intel) or big endian 
  (Sun Sparc, Motorola) machines.
</ul>

<p>
Usage:  epstool [option] operation filename
</p>
 <table>
 <tr>
   <td><b>Options:</b></td><td></td>
 </tr>
 <tr>
     <td>&nbsp;&nbsp; -b          </td><td>Calculate BoundingBox from image</td>
 </tr>
 <tr>
     <td>&nbsp;&nbsp; -gcommand   </td><td>Ghostscript command</td>
 </tr>
 <tr>
     <td>&nbsp;&nbsp; -nnumber    </td><td>Page number to extract</td>
 </tr>
 <tr>
     <td>&nbsp;&nbsp; -ofilename  </td><td>Output filename</td>
 </tr>
 <tr>
     <td>&nbsp;&nbsp; -q          </td><td>Quiet (no messages)</td>
 </tr>
 <tr>
     <td>&nbsp;&nbsp; -rnumber    </td><td>Preview resolution in dpi</td>
 </tr>
 <tr>
     <td>&nbsp;&nbsp; -sWIDTHxHEIGHT </td><td>Size of page used with -b</td>
 </tr>
 <tr>
     <td>&nbsp;&nbsp; -zdevice    </td><td>Ghostscript device name (for -t6u, -t6p, -tg, -w)</td>
 </tr>
 <tr>
     <td>&nbsp;&nbsp; -d          </td><td>Debug mode (leave temporary files)</td>
 </tr>
 <tr>
  <td><b>Operations: (one only)</b></td><td></td>
 </tr>
 <tr>
     <td>&nbsp;&nbsp; -i   </td><td>Add Interchange preview (EPSI)</td>
 </tr>
 <tr>
     <td>&nbsp;&nbsp; -t4  </td><td>Add TIFF4 preview       (DOS EPS)</td>
 </tr>
 <tr>
     <td>&nbsp;&nbsp; -t6u </td><td>Add TIFF6 uncompressed  (DOS EPS)</td>
 </tr>
 <tr>
     <td>&nbsp;&nbsp; -t6p </td><td>Add TIFF6 packbits      (DOS EPS)</td>
 </tr>
 <tr>
     <td>&nbsp;&nbsp; -tg  </td><td>Add GS TIFF preview     (DOS EPS)</td>
 </tr>
 <tr>
     <td>&nbsp;&nbsp; -w   </td><td>Add WMF preview         (DOS EPS)</td>
 </tr>
 <tr>
     <td>&nbsp;&nbsp; -ufilename </td><td>Add user supplied preview (DOS EPS)</td>
 </tr>
 <tr>
     <td>&nbsp;&nbsp; -p   </td><td>Extract PostScript      (DOS EPS)</td>
 </tr>
 <tr>
     <td>&nbsp;&nbsp; -v   </td><td>Extract Preview         (DOS EPS)</td>
 </tr>
 <tr>
     <td>&nbsp;&nbsp; -c   </td><td>Copy without preview    (use with -b)</td>
 </tr>
 </table>



<h2>
<a name="Examples"></a>
Examples
</h2>

<p>
Create EPS file tiger.eps with TIFF (G3 Fax) preview
<br><tt>
&nbsp;  epstool -tg -ztiffg3 -g"gswin32c -Id:\gs;d:\psfonts" -otiger.eps tiger.ps
</tt><br>
Any GS TIFF device can be used, e.g. -ztiffg4, -ztiffpack
</p>

<p>
Add colour preview (8bit/pixel) to EPS file
<br><tt>
&nbsp;  epstool -t6p -zbmp256 -g"gswin32c -Id:\gs;d:\psfonts" -otiger.eps tiger.ps
</tt>
</p>

<p>
Extract TIFF preview from tiger.eps
<br><tt>
&nbsp;  epstool -v -otiger.tif tiger.eps
</tt>
</p>

<p>
EPS file has incorrect %%BoundingBox.
Add TIFF4 preview and calculate %%BoundingBox from bitmap.
<br><tt>
&nbsp;  epstool -b -t4 -g"gswin32c -Id:\gs;d:\psfonts" -ogolfer.eps golfer.ps
</tt>
</p>

<p>
Adjust the BoundingBox of an existing EPS file, but don't add a preview:
<br><tt>
&nbsp;  epstool -b -t4 -otemp.eps existing.eps
<br>
&nbsp;  epstool -p -oexisting.eps temp.eps
<br>
&nbsp;  del temp.eps
</tt><br>
or
<br><tt>
&nbsp;  epstool -b -c -otemp.eps existing.eps
<br>
&nbsp;  del existing.eps
<br>
&nbsp;  rename temp.eps existing.eps
</tt>
</p>

<p>
Add user supplied Windows Metafile to EPS file.
Typically used when an application can export EPS and WMF separately
but can't export EPS with WMF preview.
<br><tt>
&nbsp;  epstool -ulogo.wmf -ologo2.eps logo.eps
</tt>
</p>


<h2>
<a name="Notes"></a>
Notes
</h2>

<p>
When extracting a page number with "-n", it is your responsibility
to make sure that the PostScript file does not use any operators
that are forbidden in EPS files.
This can be tested with GSview "EPS Warn".
</p>

<p>
Under OS/2 or MS-DOS, epstool requires Ghostscript 3.51 or later.
If you have command line length problems, try setting the Ghostscript
include path using the GS_LIB environment variable instead of using
-g"c:\gs3.51\gswin32c.exe -Ic:\gs3.51;c:\gs3.51\fonts;c:\psfonts"
</p>

<p>
For Windows 95 or Windows NT, use gswin32c.exe.  If you installed
Aladdin Ghostscript using the self installer, epstool should 
automatically find the latest Ghostscript command line executable.
For OS/2, use gsos2.exe.
For MS-DOS, use gs386.exe.
</p>

<p>
The "-b   Calculate BoundingBox from image" option works by scanning
a bitmap returned by Ghostscript.  This will only work for the
operations -i, -t4, -t6u, -t6p, -w and -c.  It does not work with -tg 
or -ufilename. -tg does not return a bitmap in a format understood
by epstool.  -ufilename does not even use Ghostscript.
The bitmap size normally used is 216mm wide (letter width) by 
297mm high (A4 height).  If the DSC comments specify a default
page size using %%DocumentMedia or %%PaperSize, 
then this page size will be used instead.  
Any marks made outside this area will be ignored when calculating
the bounding box.
To use a different bitmap size, specify the size in pts (1/72") 
using -sWIDTHxHEIGHT.  For example, A3 is -s1190x842.
</p>

<p>
The "-zdevice" should only be used with -tg, -t6u, -t6p and -w.
</p>

<p>
For -tg, the -zdevice may be any TIFF device.
</p>

<p>
For -t6u, -t6p and -w:
Under OS/2 or MS-DOS, -zdevice can be one of the following:
  bmpmono, bmp16, bmp256, bmp16m, pbmraw, pgmraw, ppmraw
Under Unix, -zdevice can be one of the following:
  pbmraw, pgmraw, ppmraw
</p>

<p>
To get a colour preview, you must use -zdevice.
The default device used by epstool is monochrome (bmpmono or pbmraw).
</p>

<p>
When adding a WMF preview using -w, the preview contains a bitmap,
not a vector representation.  If -zdevice is not used, the
Ghostscript device bmpmono or pbmraw will be used to create the bitmap.
The bitmap in the metafile will be 1bit/pixel black and white.
<br><tt>
  epstool -b -w -onew.eps old.eps
</tt><br>
If you want a colour bitmap in the metafile, specify a bitmap device 
which supports colour.
<br><tt>
  epstool -b -w -zbmp256 -onew.eps old.eps
</tt>
</p>

<p>
When adding a WMF preview to an EPS file using -ufilename, the
placeable metafile header is removed from the metafile as it is put 
into the EPS file.
When extracting a WMF preview from an EPS file, a placeable metafile
header is created from the EPS BoundingBox information.  
This placeable metafile header assumes that the WMF has it's origin 
at (0,0), which might not be correct.
</p>

<p>
The environment variable TEMP should point to a writeable directory
for temporary files.  If not defined, /tmp will be used for Unix
and the current directory will be used for other platforms.
</p>

<h2>
<a name="Copyright"></a>
Copyright
</h2>

<p>
  Copyright (C) 1995-2000, Ghostgum Software Pty Ltd.  All rights reserved.
</p>
  
<p>
  This file is part of GSview.
</p>
  
<p>
  This program is distributed with NO WARRANTY OF ANY KIND.  No author
  or distributor accepts any responsibility for the consequences of using it,
  or for whether it serves any particular purpose or works at all, unless he
  or she says so in writing.  Refer to the GSview Free Public Licence 
  (the "Licence") for full details.
</p>
  
<p>
  Every copy of GSview must include a copy of the Licence, normally in a 
  plain ASCII text file named LICENCE.  The Licence grants you the right 
  to copy, modify and redistribute GSview, but only under certain conditions 
  described in the Licence.  Among other things, the Licence requires that 
  the copyright notice and this notice be preserved on all copies.
</p>

<p>
  Author: Russell Lang, Ghostgum Software Pty Ltd
<br>
  Internet: gsview at ghostgum.com.au
</p>

<h2>
<a name="Other"></a>
Other tools
</h2>
<p>
Other tools that can add previews to EPS files are
</p>
<ul>
<li> <a href="http://www.cs.wisc.edu/~ghost/gsview/index.htm">GSview</A> 
    (same code as epstool)
<li> ps2epsi, which is part of <A HREF="http://www.cs.wisc.edu/~ghost/aladdin/index.html">Ghostscript</A>.
   This only adds Interchange previews.
<li> <a href="http://www.umich.edu/~archive/mac/util/text/ps2epsplus.sit.hqx">
     ps2epsplus</A> for creating Mac EPS files on a Mac.
<li> <a href="http://www.umich.edu/~archive/mac/util/unix/ps2epsmac1.3.shar">
     ps2epsmac</A> for creating Mac EPS files under Unix.

</ul>

<h2>
<a name="Revision"></a>
Revision History
</h2>
<h3>
1.6 2000-12-28
</h3>
<p>
  Release with GSview 3.6.
<br>
  Write correct page ordinal when extracting a page.
<br>
  Correctly handle DOS EPS files again.
</p>
<h3>
<h3>
1.5 2000-12-16
</h3>
<p>
  Release with GSview 3.5.
</p>
<h3>
1.32 2000-11-06
</h3>
<p>
  Updated DSC parser.
<br>
  Release with GSview 3.41 beta.
</p>
<h3>
1.4 2000-06-30
</h3>
<p>
  Fixed handling of files without trailers.
</p>
<h3>
1.3 2000-06-25
</h3>
<p>
  Put quotes around Ghostscript EXE name for Windows, OS/2 and Unix.
  Released with GSview 3.1.
</p>
<h3>
1.21 2000-06-15
</h3>
<p>
  Minor fixes for Linux build.
</p>
<h3>
1.2 2000-06-15
</h3>
<p>
  Release with GSview 3.0.
</p>
<h3>
1.10 2000-04-01
</h3>
<p>
  Fixes to DSC parser.
</p>
<h3>
1.09 2000-03-11
</h3>
<p>
  New DSC parser.
<br>
  Added #pragma pack(1) needed by MSVC++.
<br>
  Modified BMP reading so it works even if byte packing not used.
<br>,
  BMP reading might now work with big-endian architectures, so
  might be able to use BMP devices on Unix (if compiled into Ghostscript).
  (Untested).
</p>
<h3>
1.08 2000-02-15
</h3>
<p>
  Fixed incorrect switch statement in psfile_extract_header()
<br>
  Fixed -b -c to change the first line to EPS.
<br>
  Added -sWIDTHxHEIGHT for use with -b -c and large page sizes.
</p>

<h3>
1.07 1998-12-23
</h3>
<p>
  Cope with badly written EPS files that leave items on
  the stack or dictionary stack.
</p>

<h3>
1.06 1998-09-13
</h3>
<p>
  Page calculation for descending page order was wrong.
<br>
  If a multipage non-EPS file was used as input, the output
  didn't contain the correct single page (or copied garbage).
<br>
  Added macro for SUNOS4 to use bcopy instead of memmove.
</p>

<h3>
1.05 1997-12-09
</h3>
<p>
  When calculating the bounding box from a bitmap, round the
  area outwards by 0.5 pixels.
</p>

<h3>
1.04 1997-11-29
</h3>
<p>
  Released with GSview 2.4
</p>

<h3>
1.03 1997-09-22
</h3>
<p>
  TIFF4 preview didn't work from 24bit/pixel source bitmap.
<br>
  TIFF 6 packbits didn't compress properly for some data (and
  consquently caused heap corruption).
<br>
  Fixed TIFF 6 output when using palette (4 or 8 bit/pixel).
</p>

<h3>
1.02 1997-02-15
</h3>
<p>
  Removed requirement for EPS file to use showpage.
<br>
  Added -c to allow correction of %%BoundingBox
<br>
  When calculating %%BoundingBox, render to a page of letter
  width and A4 height.
<br>
  Avoid integer overflow on 16bit machines when calculating width 
  and height.
<br>
  If TEMP undefined, default to /tmp on Unix.
</p>

<h3>
1.01 1996-11-07
</h3>
<p>
  Release separate from GSview.  No code changes.
<br>
  Includes Win32 (epstool.exe) and OS/2 (epstool2.exe) EXEs.
</p>

<h3>
1.0 1996-10-13
</h3>
<p>
  Not a beta version.  Included with GSview 2.1.
</p>

<h3>
0.81 beta 1996-09-12
</h3>
<p>
  Added TIFF packbits compression.
<br>
  Added -zdevice.
<br>
  -t5 replaced by -t6u, -t6p.
<br>
  -wdevice replaced by -w -zdevice
<br>
  -ttiff3 replaced by -tg -ztiffg3
</p>

<h3>
0.8 beta 1996-09-09
</h3>
<p>
  Makefile target for Win32.
<br>
  Add WMF for all platforms.
<br>
  Removed restriction that structures must be byte aligned under Unix.
<br>
  Must still be byte aligned under DOS and OS/2.
<br>

<h3>
0.7 alpha 1995-10-20
</h3>
<p>
  Fixed a few error messages.
<br>
  Use @file to reduce Ghostscript command line length under MS-DOS and OS/2.
<br>
  Added -q option to GSview and -dQUIET option to Ghostscript command line 
  to allow EPS files to be written to stdout.
</p>

<h3>
0.6 alpha 1995-10-12
</h3>
<p>
  Delete temporary bmp file.
<br>
  Add user supplied preview to a DOS EPS file (which already had a
  preview) was wrong.
</p>

<h3>
0.5 alpha 1995-09-27
</h3>
<p>
  Put stdout into binary mode.
<br>
  Write placeable WMF header correctly on 32bit and big-endian machines.
</p>

<h3>
0.4 alpha 1995-09-15
</h3>
<p>
  Remove placeable WMF header when adding to EPS file, add placeable
<br>
  WMF header when extracting from EPS file.
</p>

<h3>
0.3 alpha 1995-09-14
</h3>
<p>
  First release separate from GSview.
</p>

<h2>
<a name="End"></a>
End of epstool documentation
</h2>
</body>
</html>
